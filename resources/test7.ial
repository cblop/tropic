institution starWars;
% TYPES ----------
type Agent;
type Role;
type Trope;
type Phase;
type Place;
type PlaceName;
type Quest;
type Object;
type ObjectName;

% FLUENTS ----------
fluent role(Agent, Role);
fluent phase(Trope, Phase);
fluent place(PlaceName, Place);
fluent object(ObjectName, Object);
fluent at(Agent, Place);

% EXTERNAL EVENTS: The Hero's Journey ----------
exogenous event go(Agent, PlaceName);
exogenous event meet(Agent, Agent);
exogenous event noDeadline;

% VIOLATION EVENTS: The Hero's Journey ----------
violation event violHeroGoAway;
violation event noViolation;

% INST EVENTS: The Hero's Journey ----------
inst event intHerosJourney(Agent, Agent, Agent, PlaceName, PlaceName);
inst event intGo(Agent, PlaceName);

% OBLIGATION FLUENTS: The Hero's Journey ----------
obligation fluent obl(go(Agent, PlaceName), go(Agent, PlaceName), violHeroGoAway);

% INITIATES: The Hero's Journey ----------
intHerosJourney(R, S, T, U, V) initiates
    phase(herosJourney, phaseA),
    perm(go(R, V)) if
        phase(herosJourney, inactive),
        role(R, hero),
        place(V, home);
intHerosJourney(R, S, T, U, V) initiates
    phase(herosJourney, phaseB),
    obl(go(R, U), go(S, V), violHeroGoAway) if
        phase(herosJourney, phaseA),
        role(R, hero),
        place(U, away),
        role(S, villain),
        place(V, home);
intHerosJourney(R, S, T, U, V) initiates
    phase(herosJourney, phaseC),
    perm(meet(R, T)) if
        phase(herosJourney, phaseB),
        role(T, dispatcher),
        role(R, hero);
intHerosJourney(R, S, T, U, V) initiates
    phase(herosJourney, phaseD),
    perm(go(R, V)) if
        phase(herosJourney, phaseC),
        role(R, hero),
        place(V, home);
intHerosJourney(R, S, T, U, V) initiates
    phase(herosJourney, done) if
        phase(herosJourney, phaseD);
violHeroGoAway initiates
    perm(kill(R, S)) if
        role(R, hero),
        role(S, villain);


% TERMINATES: The Hero's Journey ----------
intHerosJourney(R, S, T, U, V) terminates
    phase(herosJourney, inactive) if
        phase(herosJourney, inactive);
intHerosJourney(R, S, T, U, V) terminates
    phase(herosJourney, phaseA),
    perm(go(R, V)) if
        phase(herosJourney, phaseA);
intHerosJourney(R, S, T, U, V) terminates
    phase(herosJourney, phaseB),
    obl(go(R, U), go(S, V), violHeroGoAway) if
        phase(herosJourney, phaseB);
intHerosJourney(R, S, T, U, V) terminates
    phase(herosJourney, phaseC),
    perm(meet(R, T)) if
        phase(herosJourney, phaseC);
intHerosJourney(R, S, T, U, V) terminates
    phase(herosJourney, phaseD),
    perm(go(R, V)) if
        phase(herosJourney, phaseD);
intHerosJourney(R, S, T, U, V) terminates
    phase(herosJourney, done) if
        phase(herosJourney, done);
intGo(S, U) terminates
    obl(go(R, T), go(S, U), violHeroGoAway) if
        role(R, hero),
        place(T, away),
        role(S, villain),
        place(U, home);


% GENERATES: The Hero's Journey ----------
go(R, V) generates
    intHerosJourney(R, S, T, U, V) if
        role(R, hero),
        place(V, home);
meet(R, T) generates
    intHerosJourney(R, S, T, U, V) if
        role(T, dispatcher),
        role(R, hero);
go(R, T) generates
    intGo(R, T) if
        role(R, hero),
        place(T, away);



% INITIALLY: -----------
initially
    pow(intHerosJourney(R, S, T, U, V)) if R != S, S != T, T != U, U != V;
initially
    pow(intGo(S, U)),
    phase(herosJourney, inactive),
    role(lukeSkywalker, hero),
    role(obiWan, dispatcher),
    role(darthVader, villain),
    place(tatooine, home),
    place(space, away);
